% Theory chapter
\chapter{Theory overview}
\label{theory}
This chapter consists in describing the basics notion about the robot, to understand better the entire work made on \textbf{KUKA LBR IIWA}. Morover a description about the kinematic chains, the types of kinematic and about the most used notation is provided. Also an overview of different robot controls is provided.

%----------------------------------------------------------------------------------------

\section{About the robot}
\label{about-the-robot}
The \textit{KUKA LBR IIWA} is a robot with collaborative features. It has a 14 kg payload and it has an action range from $ 800mm $ to $ 820 mm $. It is one of the latest robotic innovation, with the ability to work with humans. It has built in sensors and soft edges that make it safe for human collaboration and the ability to detect movement and touch all over. Moreover it has a media flange, with an internal wiring that is helpful to attach a lot of tools. When a tool is attached it's considered in the kinematic chain. In our case the tool selected is a \textit{Gimatic MPLM3240} that is a eletric parallel gripper with 2 self-centering two jaw. It has a total gripping force of $ 210 N $.

\begin{figure}[H]
	\centering
	\includegraphics{figures/kuka_lbr_iiwa.png}
	\caption{The Kuka LBR IIWA}
\end{figure}


\section{Kinematic chains}
\label{kinematic-chains}
Kinematics is the science of motion that allows to represent positions and velocities of specified points of a complex structure composed by multiple sections, without mention force and torques that cause the motion. To talk about kinematic the concept of \textit{kinematic chains} must be introduced.

A kinematic chain represents the mechanical structure of a robot manipulator. It is a set of ideal rigid links connected by ideal rigid joints and it is considered as a geometric entity, therefore masses and frictions of the kinematic chain are not considered. At the base of the chain there's the fixed frame, usually a table or another rigid support. At the end there's the TCP that's a point, generally located in the middle of the end-effector, that a manipulator moves to a specific position or along a specified path. In figure \ref{fig:kin-example} an example of a simple kinematic chain. 

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.6]{figures/kin_chain.png}
	\caption{An example of kinematic chain.}
	\label{fig:kin-example}
\end{figure}

While the end-effector is a rigid body that moves in three dimensional space, the TCP has a position and an orientation based on the fixed frame at the base of the robot. When the TCP is defined as combination of position and orientation, it's said to be a \textit{pose}.

Joints and links are components of the kinematic chain that allows re motion between each other. In robotics there are different types of joints:
\begin{itemize}
	\item \textit{Revolute} and \textit{prismatic} joints, with a single DOF. The first one allows rotation about a single axis, while the second one provides a traslation along a specific axis. In figure~\ref{fig:joint} a revolute joint.
	\item \textit{Hooke's} and \textit{sphere} joints. A coupling connecting rigid rods whose axes are inclined to each other.
\end{itemize}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.15]{figures/revolute_joint.png}
	\caption{A revolute joint, the same in KUKA IIWA}
	\label{fig:joint}
\end{figure}

In our robot there are only revolute joints, in particular the IIWA has seven which correspond to the robot's DOF. If more DOFs than task variables are available, the manipulator is referred to as a redundant robot, therefore our robot is a redundant robot.

\subsection{Types of Kinematic Chains}
\label{types-kinematic-chains}
We talk about two different types of kinematic chains:
\begin{itemize}
	\item \textit{Open kinematic chains}: it's a chain in which every joint connects only two links. Therefore there's only one sequence of links connecting the end of the chain. We can refer to a human arm, so the reachable task space is big but not accurated.
	\item \textit{Close kinematic chains}: is's a chain where there are more than one link between two joints. It has a cycle structure but it can provide an high accuracy but in a small workspace, so the space reachable by the end-effector is limited.
\end{itemize}


\section{Kinematic}	
From \cite{reference4}, there are two different types of kinematic that describe the behavior of the robot. In the next sections a little introduction about them is provided. Moreover a description on the commonly used notation for selecting references frame is provided in section~\ref{dh}.
	
	\subsection{Forward Kinematic}
	\label{forward-kinematic}
	Forward kinematics describes the pose of the EE respect to the world frame, depending on the robot's geometry and based on the angles (revolute) or offset (prismatic) of the robot's joints. The EE pose can be defined by specifying the manipulator's geometry and joint displacements necessary to achive the pose. When the pose is defines in this way, the TCP is described in the joint space: every joint has a value of offset or angles. A joint motion in joint space produces a motion of the EE in the task space.


	\subsection{Inverse Kinematic}
	\label{inverse-kinematic}		
	When we talk about inverse kinematics we mean the opposite process. Given a TCP pose respect to the world frame, the necessary joint values to reach that pose must be found. If the TCP pose is out of the reachable joint state the inverse kinematic cannot be found.
	
	\begin{figure}[H]
		\centering
		\includegraphics[scale=0.35]{figures/forward_inverse_kinematic.jpg}
		\caption{An easy way to understand FK and IK}
		\label{fig:for-inv-kinematic}
	\end{figure}
	
	
	\subsection{Denavitâ€“Hartenberg Convention}
	\label{dh}
	As mentioned in the introduction, the \textit{DH} conventions is used for selecting the reference frames. This method allows to attach a reference frame to each link of the robot and it uses certain parameters to describe the position and orientation of each reference frame. In particular, in this method the relative position and orientation of two consecutive links are defined. Usually the Frame $ 0 $ is the frame attached to the robot base and doesn't move.
	
	There are two version of the \textit{DH} convention: we use the standard one. The standard version, once the reference frame have been established provides four parameters that describe the position and the orientation of a single frame:
	\begin{itemize}
		\item $ a_i $: the link length is the distance from $ Z_i $ to $ Z_{i+1} $ measured along $ X_i $
		\item $ \alpha _i $: the twist angle is the angle from $ Z_i $ to $ Z_{i+1} $ measured about $ X_i $
		\item $ d_i $: the offset lenght is the distance from $ X_{i-1} $ to $ X_{i} $ measured along $ Z_i $
		\item $ \theta _i $: the joint angle is the angle between $ X_{i-1} $ to $ X_{i} $ measured about $ Z_i $
	\end{itemize}

	The first two parameters depend only on the connection of link $ i $ with the consecutive one. One of the other two remaining parameters varies depending on the type of joint, in particular:
	\begin{itemize}
		\item if the joint $ i $ is a \textit{prismatic joint}, the joint variable is $ d_i $
		\item if the joint $ i $ is a \textit{revolute joint}, the joint variable is $ \theta _i $
	\end{itemize}

	After that the parameters have been found for every link, it's possible to express the coordinate transformation between link $ i-1 $ and link $ i $ using translation and rotation matrices.

% TODO cinematica e DH scritto meglio?

\section{Theory about robot control}
\label{robot-control}		

	\subsection{Postion control}
	\label{position-control}
	
	\subsection{Cartesian impedance control}
	\label{cartesian-impedance-control}
	
	\subsection{Joint impedance control}
	\label{joint-impedance-control}
	